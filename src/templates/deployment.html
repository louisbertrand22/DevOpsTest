{% extends "base.html" %}

{% block title %}Guide de DÃ©ploiement - DevOps Azure{% endblock %}

{% block header_title %}â˜ï¸ Guide de DÃ©ploiement Azure{% endblock %}
{% block header_subtitle %}Comment cette application est dÃ©ployÃ©e sur Azure Kubernetes Service{% endblock %}

{% block nav_extra %}
<a href="#overview">Vue d'ensemble</a>
<a href="#github-actions">GitHub Actions</a>
<a href="#docker">Build Docker</a>
<a href="#aks">DÃ©ploiement AKS</a>
<a href="#networking">RÃ©seau & Domaine</a>
<a href="#ssl">SSL/TLS</a>
{% endblock %}

{% block content %}
<section id="overview" class="section">
    <h2>ğŸ¯ Vue d'ensemble du DÃ©ploiement</h2>
    <p>Cette application Flask est dÃ©ployÃ©e sur Azure Kubernetes Service (AKS) et accessible via le domaine <code>app.lucho-dev.xyz</code>. Le processus de dÃ©ploiement est entiÃ¨rement automatisÃ© grÃ¢ce Ã  GitHub Actions.</p>
    
    <h3>Architecture de DÃ©ploiement</h3>
    <div class="flow-diagram">
        <div class="flow-step">GitHub Push</div>
        <span class="flow-arrow">â†’</span>
        <div class="flow-step">GitHub Actions</div>
        <span class="flow-arrow">â†’</span>
        <div class="flow-step">Build Docker</div>
        <span class="flow-arrow">â†’</span>
        <div class="flow-step">Push vers Registres</div>
        <span class="flow-arrow">â†’</span>
        <div class="flow-step">DÃ©ploiement AKS</div>
        <span class="flow-arrow">â†’</span>
        <div class="flow-step">Ingress NGINX</div>
        <span class="flow-arrow">â†’</span>
        <div class="flow-step">app.lucho-dev.xyz</div>
    </div>
    
    <h3>Composants ClÃ©s</h3>
    <ul>
        <li><strong>GitHub Actions</strong> : Pipeline CI/CD automatisÃ©</li>
        <li><strong>Docker Hub</strong> : Registre d'images public (docker.io/louisdev22/devopstest)</li>
        <li><strong>Azure Container Registry (ACR)</strong> : Registre privÃ© Azure (devopstestaksregistry.azurecr.io)</li>
        <li><strong>Azure Kubernetes Service (AKS)</strong> : Cluster Kubernetes managÃ©</li>
        <li><strong>NGINX Ingress Controller</strong> : Routage du trafic HTTP/HTTPS</li>
        <li><strong>cert-manager</strong> : Gestion automatique des certificats SSL</li>
        <li><strong>Let's Encrypt</strong> : Certificats SSL gratuits</li>
    </ul>
</section>

<section id="github-actions" class="section">
    <h2>ğŸ”„ Pipeline GitHub Actions</h2>
    <p>Le fichier <code>.github/workflows/deploy.yml</code> dÃ©finit un pipeline CI/CD en deux Ã©tapes : <strong>Build</strong> et <strong>Deploy</strong>.</p>
    
    <h3>Ã‰tape 1 : Build</h3>
    <p>Cette Ã©tape s'exÃ©cute Ã  chaque push sur les branches <code>main</code> ou <code>master</code>.</p>
    
    <div class="info-box">
        <strong>ğŸ’¡ Secrets GitHub requis :</strong>
        <ul style="margin-top: 10px;">
            <li><code>DOCKERHUB_USERNAME</code> et <code>DOCKERHUB_TOKEN</code></li>
            <li><code>AZURE_ACR_USERNAME</code> et <code>AZURE_ACR_PASSWORD</code></li>
            <li><code>KUBECONFIG</code> (pour l'Ã©tape de dÃ©ploiement)</li>
        </ul>
    </div>
</section>

<section id="docker" class="section">
    <h2>ğŸ³ Build de l'Image Docker</h2>
    <p>L'application est empaquetÃ©e dans une image Docker lÃ©gÃ¨re basÃ©e sur Python 3.12.</p>
</section>

<section id="aks" class="section">
    <h2>â˜¸ï¸ DÃ©ploiement sur Azure Kubernetes Service</h2>
    <p>L'application s'exÃ©cute dans un cluster AKS avec les manifests Kubernetes.</p>
</section>

<section id="networking" class="section">
    <h2>ğŸŒ RÃ©seau et Configuration du Domaine</h2>
    <p>Le trafic externe vers l'application passe par un contrÃ´leur NGINX Ingress qui route les requÃªtes vers le Service Kubernetes.</p>
</section>

<section id="ssl" class="section">
    <h2>ğŸ”’ Certificats SSL/TLS avec cert-manager</h2>
    <p>Les certificats SSL sont gÃ©rÃ©s automatiquement par <strong>cert-manager</strong> et Ã©mis gratuitement par <strong>Let's Encrypt</strong>.</p>
    
    <div class="success-box">
        <strong>âœ… RÃ©sultat :</strong> L'application est accessible en HTTPS sur <a href="https://app.lucho-dev.xyz" target="_blank">https://app.lucho-dev.xyz</a> avec un certificat SSL valide !
    </div>
</section>
{% endblock %}
